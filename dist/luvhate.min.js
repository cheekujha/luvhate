/*! luvhate 03-05-2015 */
!function(window,angular){angular.module("facebook",[])}(window,angular),function(window,angular){function facebookFactory($q){function browserInit(id,version){this.appID=id,this.appVersion=version||"v2.0",facebookConnectPlugin.browserInit(this.appID,this.appVersion)}function login(permissions){var q=$q.defer();return facebookConnectPlugin.login(permissions,function(res){q.resolve(res)},function(res){q.reject(res)}),q.promise}function showDialog(options){var q=$q.defer();return facebookConnectPlugin.showDialog(options,function(res){q.resolve(res)},function(err){q.reject(err)}),q.promise}function api(path,permissions){var q=$q.defer();return facebookConnectPlugin.api(path,permissions,function(res){q.resolve(res)},function(err){q.reject(err)}),q.promise}function getAccessToken(){var q=$q.defer();return facebookConnectPlugin.getAccessToken(function(res){q.resolve(res)},function(err){q.reject(err)}),q.promise}function getLoginStatus(){var q=$q.defer();return facebookConnectPlugin.getLoginStatus(function(res){q.resolve(res)},function(err){q.reject(err)}),q.promise}function logout(){var q=$q.defer();return facebookConnectPlugin.logout(function(res){q.resolve(res)},function(err){q.reject(err)}),q.promise}return{browserInit:browserInit,login:login,showDialog:showDialog,api:api,getAccessToken:getAccessToken,getLoginStatus:getLoginStatus,logout:logout}}angular.module("facebook").factory("facebookFactory",facebookFactory),facebookFactory.$inject=["$q"]}(window,angular),function(window,angular){angular.module("login",[])}(window,angular),function(window,angular){function loginCtrl($scope,facebookFactory,$state){function init(){initMethods()}function initMethods(){vm.facebookLogin=facebookLogin}function facebookLogin(){facebookFactory.login(["user_friends","public_profile","read_custom_friendlists"]).then(loginSuccess,loginError)}function loginSuccess(response){$state.go("home.profile"),console.log("facebookLogin success",response)}function loginError(response){console.log("facebookLogin error",response)}var vm=this;init()}angular.module("login").controller("loginCtrl",loginCtrl),loginCtrl.$inject=["$scope","facebookFactory","$state"]}(window,angular),function(window,angular){angular.module("peopleSearch",[])}(window,angular),function(window,angular){function peopleSearchCtrl($scope,peopleSearchFactory,friendSearchFactory){function init(){vm.peopleList=[],vm.showLoadMoreButton=!1,vm.friendList=[],vm.friendListLoaded=!1,initMethods()}function initMethods(){vm.searhclicked=searhclicked,vm.loadMoreClicked=loadMoreClicked,vm.getFriendList=getFriendList,vm.loadMoreFriendClicked=loadMoreFriendClicked}function searhclicked(searchText){searchText&&searchText.trim().length>0&&peopleSearchFactory.search(searchText,"user").then(function(list){peopleSearchSuccess(list,!0)},peopleSearchError)}function peopleSearchSuccess(list,emptyList){console.log("searchSuccess",list),list.length>0?vm.showLoadMoreButton=!0:vm.showLoadMoreButton=!1,emptyList&&(vm.peopleList=[],vm.peopleList.length=0);var oldList=vm.peopleList,newList=oldList.concat(list);vm.peopleList=newList}function peopleSearchError(){console.error("searchError")}function loadMoreClicked(){peopleSearchFactory.nextSearch().then(function(list){peopleSearchSuccess(list,!1)},peopleSearchError)}function getFriendList(){vm.friendListLoaded||friendSearchFactory.search().then(friendSearchSuccess,friendSearchError)}function friendSearchSuccess(list){list.length>0?vm.showFriendLoadMoreButton=!0:vm.showFriendLoadMoreButton=!1;var oldList=vm.friendList,newList=oldList.concat(list);vm.friendList=newList,vm.friendListLoaded=!0}function friendSearchError(response){console.log("friendSearchError",response)}function loadMoreFriendClicked(){friendSearchFactory.nextSearch().then(friendSearchSuccess,friendSearchError)}var vm=this;init()}angular.module("peopleSearch").controller("peopleSearchCtrl",peopleSearchCtrl),peopleSearchCtrl.$inject=["$scope","peopleSearchFactory","friendSearchFactory"]}(window,angular),function(window,angular){function friendSearchFactory(facebookFactory,$q){function search(){var defer=$q.defer(),path="/me/friends?debug=all";return nextSearchPath=null,friendList=[],facebookFactory.api(path,["user_friends"]).then(function(response){response&&(setFriendList(response.data),setPaginationValues(response.data,response.paging)),defer.resolve(friendList)},function(response){defer.reject()}),defer.promise}function setFriendList(list){list&&list.length>0&&(friendList=friendList.concat(list))}function setPaginationValues(list,pagingData){nextSearchPath=list.length>0&&pagingData?formatNextPath(pagingData.next):null}function nextSearch(){var defer=$q.defer();return nextSearchPath?facebookFactory.api("me/"+nextSearchPath,["user_friends"]).then(function(response){response&&(setFriendList(response.data),setPaginationValues(response.data,response.paging)),defer.resolve(response.data)},function(response){defer.reject(response)}):defer.resolve([]),defer.promise}function formatNextPath(path){if(path){var indexOfSearch=path.indexOf("friends");return indexOfSearch>=0?path.substring(indexOfSearch):null}return null}var friendList=[],nextSearchPath=null;return{search:search,nextSearch:nextSearch}}angular.module("peopleSearch").factory("friendSearchFactory",friendSearchFactory),friendSearchFactory.$inject=["facebookFactory","$q"]}(window,angular),function(window,angular){function peopleSearchFactory(facebookFactory,$q){function search(query,type){var defer=$q.defer(),path="/search?q="+query+"&type="+type;return nextSearchPath=query,nextSearchPath=null,facebookFactory.api(path,[]).then(function(response){response&&(setPeopleList(response.data,!0),setPaginationValues(response.data,response.paging)),defer.resolve(peopleList)},function(response){defer.reject()}),defer.promise}function setPeopleList(list,emptyList){emptyList&&(peopleList=[],peopleList.length=0),list&&list.length>0&&(peopleList=peopleList.concat(list))}function setPaginationValues(list,pagingData){nextSearchPath=list.length>0&&pagingData?formatNextPath(pagingData.next):null}function nextSearch(){var defer=$q.defer();return nextSearchPath?facebookFactory.api(nextSearchPath,[]).then(function(response){response&&(setPeopleList(response.data,!1),setPaginationValues(response.data,response.paging)),defer.resolve(response.data)},function(response){defer.reject(response)}):defer.resolve([]),defer.promise}function formatNextPath(path){if(path){var indexOfSearch=path.indexOf("search");return indexOfSearch>=0?path.substring(indexOfSearch):null}return null}var peopleList=[],nextSearchPath=null;return{search:search,nextSearch:nextSearch}}angular.module("peopleSearch").factory("peopleSearchFactory",peopleSearchFactory),peopleSearchFactory.$inject=["facebookFactory","$q"]}(window,angular),function(window,angular){angular.module("searchListItem",[])}(window,angular),function(window,angular){function searchListItemCtrl($scope){function init(){initMethods()}function initMethods(){}init()}angular.module("searchListItem").controller("searchListItemCtrl",searchListItemCtrl),searchListItemCtrl.$inject=["$scope"]}(window,angular),function(window,angular){function searchListItem(){return{restrict:"E",scope:{profile:"="},templateUrl:"modules/search-list-item/partials/SearchListItem.html",controller:"searchListItemCtrl",controllerAs:"vm",link:function(scope,element,attrs,ctrl){ctrl.profile=scope.profile}}}angular.module("searchListItem").directive("searchListItem",searchListItem),searchListItem.$inject=[]}(window,angular),function(window,angular){angular.module("userProfile",[])}(window,angular),function(window,angular){function userProfileCtrl($scope,facebookFactory,$state){function init(){initMethods()}function initMethods(){vm.logoutClicked=logoutClicked}function logoutClicked(){facebookFactory.logout().then(logoutSuccess,function(){alrt("logout error")})}function logoutSuccess(){$state.go("home.login")}var vm=this;init()}angular.module("userProfile").controller("userProfileCtrl",userProfileCtrl),userProfileCtrl.$inject=["$scope","facebookFactory","$state"]}(window,angular),function(window,angular){angular.module("common",[])}(window,angular),function(window,angular){function facebookEnums(){return{status:{connected:"connected",notAuthorized:"not_anuthorized",unknown:"unknown"}}}angular.module("common").constant("facebookEnums",facebookEnums())}(window,angular),function(window,angular){function mainCtrl($scope,$timeout,facebookFactory,$window,facebookEnums,$state){function init(){initMethods(),initListeners()}function initMethods(){vm.fbLoginStatus=fbLoginStatus,vm.fbLogin=fbLogin,vm.fbLogout=fbLogout,vm.search=search}function initListeners(){document.addEventListener("deviceready",onDeviceReady,!1)}function startApp(){facebookFactory.browserInit("584636644972667"),checkLoginStatus()}function checkLoginStatus(){facebookFactory.getLoginStatus().then(loginStatusSuccess,loginStatusError)}function loginStatusSuccess(response){alert(">>>>>>>>>loginStatusSuccess>>>>>>>>>>>>>>>>>>",response),$state.go(response.status===facebookEnums.status.connected?".profile":".login")}function loginStatusError(response){console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>",response)}function onDeviceReady(){alert("device ready"),startApp()}function search(){alert("MAKING REQUEST"),facebookConnectPlugin.api("/search?q=rupal khare&type=user",[],searchSuccess,searchError)}function searchSuccess(data){alert("IN SUCCESS"),setMessageFromFacebook(data)}function searchError(data){alert("IN ERROR"),setMessageFromFacebook(data)}function fbLoginStatus(){facebookConnectPlugin.getLoginStatus(function(response){alert(response.status)},function(err){alert("Error")})}function fbLogin(){var fbLoginSuccess=function(userData){var data=JSON.stringify(userData);authResponse=data.authResponse,setMessageFromFacebook(userData)};facebookConnectPlugin.login(["public_profile"],fbLoginSuccess,function(error){alert(""+error)})}function fbLogout(){facebookConnectPlugin.logout(function(response){alert("loggedout "+response)},function(){alert("Error")})}function setMessageFromFacebook(message){$timeout(function(){vm.messageFromFacebook=JSON.stringify(message)},0)}var authResponse,vm=this;init()}angular.module("common").controller("mainCtrl",mainCtrl),mainCtrl.$inject=["$scope","$timeout","facebookFactory","$window","facebookEnums","$state"]}(window,angular),function(window,angular){window.APPNAME="luvhate",angular.module(window.APPNAME,["luvhate.templates","mobile-angular-ui","ui.router","common","facebook","login","userProfile","peopleSearch","searchListItem"]),angular.module(window.APPNAME).config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/home"),$stateProvider.state("home",{url:"/home",template:'<div ui-view class="router-view"></div>',controller:"mainCtrl",controllerAs:"vm"}).state("home.login",{templateUrl:"modules/login/partials/Login.html",controller:"loginCtrl",controllerAs:"vm"}).state("home.profile",{url:"/profile",templateUrl:"modules/user-profile/partials/UserProfile.html",controller:"userProfileCtrl",controllerAs:"vm"}).state("home.search",{templateUrl:"modules/people-search/partials/PeopleSearch.html",url:"/search",controller:"peopleSearchCtrl",controllerAs:"vm"})})}(window,angular);